<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="movieMapper">
	
	<resultMap type="movie" id="movie_rm">
		<id property="movieNo" column="MOVIE_NO"/>
		<result property="movieRuntime" 			column="MOVIE_RUNTIME"/>
		<result property="movieTitle" 				column="MOVIE_TITLE"/>
		<result property="movieNation" 				column="MOVIE_NATION"/>
		<result property="movieOpen" 				column="MOVIE_OPEN"/>
		<result property="mgNo" 					column="MG_CONTENT"/>
		<result property="movieContent" 			column="MOVIE_CONTENT"/>
		<result property="movieImg" 				column="MOVIE_IMG"/>
		<result property="moviePlayed" 				column="MOVIE_PLAYED"/>
		<result property="movieWatched" 			column="MOVIE_WATCHED"/>
		<result property="movieRegdate" 			column="MOVIE_REGDATE"/>
		<result property="movieUploader"	 		column="MOVIE_UPLOADER"/>
		<result property="movieFixdate" 			column="MOVIE_FIXDATE"/>
		<result property="movieChanger" 			column="MOVIE_CHANGER"/>
		<result property="genreCode" 				column="GENRE_NAME"/>
		<result property="movieDirector"			column="MOVIE_DIRECTOR"/>
        <result property="movieCast"				column="MOVIE_CAST"/>
	</resultMap>
		
	<!-- 영화 등록 -->
	<insert id="MovieAdd" parameterType="movie"> 
		INSERT INTO MOVIE 
    	VALUES (
    		SEQ_MOVIE_NO.NEXTVAL,
        	#{movieRuntime},
        	#{movieTitle},
        	#{movieNation},
        	#{mgNo},
        	#{movieContent},
        	#{movieImg},
        	null,
        	null,
        	default,
        	#{movieUploader},
        	null,
        	null,
        	#{genreCode},
        	#{movieDirector},
        	#{movieCast},
        	#{movieOpen}
    	)
	</insert>
	
	<!-- 영화 등록 Grade 호출 -->
	<select id="mgradeList" resultType="string">
		SELECT MG_CONTENT FROM MOVIE_GRADE
	</select>
	
	<!-- 영화 등록 Grade 호출 -->
	<select id="mgenreList" resultType="string">
		SELECT GENRE_NAME FROM GENRE
	</select>
	
	<!-- 영화 수 조회 -->
	<select id="getmovielistCount" resultType="_int">
		SELECT COUNT(MOVIE_NO) FROM MOVIE
	</select>
	
	<!-- 영화 목록에 쓰일 list 호출 -->
	<select id="movieList" resultMap="movie_rm">
		SELECT * FROM MOVIE
		ORDER BY MOVIE_NO DESC
	</select>
	
	<!-- 영화 수정 페이지 이동 후 값 불러오기 -->
	<select id="getEditMovieList" resultType="HashMap">
		SELECT * FROM MOVIE
		WHERE MOVIE_NO = #{movieNo}
	</select>
	
	<!-- 영화 수정 -->
	<update id="MovieEdit" parameterType="movie">
		UPDATE MOVIE SET
			MOVIE_RUNTIME = #{movieRuntime},
        	MOVIE_TITLE = #{movieTitle},
        	MOVIE_NATION = #{movieNation},
        	MG_CONTENT = #{mgNo},
        	MOVIE_CONTENT = #{movieContent},
        	MOVIE_IMG = #{movieImg},
        	MOVIE_PLAYED = null,
        	MOVIE_WATCHED = null,
        	MOVIE_REGDATE = default,
        	MOVIE_UPLOADER = #{movieUploader},
        	MOVIE_FIXDATE = null,
        	MOVIE_CHANGER = null,
        	GENRE_NAME = #{genreCode},
        	MOVIE_DIRECTOR = #{movieDirector},
        	MOVIE_CAST = #{movieCast},
        	MOVIE_OPEN = #{movieOpen}
			WHERE MOVIE_NO = ${movieNo}
	</update>
	
</mapper>